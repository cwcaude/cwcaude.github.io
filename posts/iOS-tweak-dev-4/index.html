<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="iOS Tweak Development : 4" /><meta property="og:locale" content="en" /><meta name="description" content="Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain and document my journey/path of learning to develop iOS tweaks. If you desire for strictly a tutorial in iOS Tweak Development check out these links here : Zane Helton or r/Jailbreak Tutorial" /><meta property="og:description" content="Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain and document my journey/path of learning to develop iOS tweaks. If you desire for strictly a tutorial in iOS Tweak Development check out these links here : Zane Helton or r/Jailbreak Tutorial" /><link rel="canonical" href="http://cwcaude.github.io/posts/iOS-tweak-dev-4/" /><meta property="og:url" content="http://cwcaude.github.io/posts/iOS-tweak-dev-4/" /><meta property="og:site_name" content="Clay Caudell" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-16T20:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="iOS Tweak Development : 4" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-04T02:41:48+00:00","datePublished":"2020-07-16T20:00:00+00:00","description":"Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain and document my journey/path of learning to develop iOS tweaks. If you desire for strictly a tutorial in iOS Tweak Development check out these links here : Zane Helton or r/Jailbreak Tutorial","headline":"iOS Tweak Development : 4","mainEntityOfPage":{"@type":"WebPage","@id":"http://cwcaude.github.io/posts/iOS-tweak-dev-4/"},"url":"http://cwcaude.github.io/posts/iOS-tweak-dev-4/"}</script><title>iOS Tweak Development : 4 | Clay Caudell</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Clay Caudell"><meta name="application-name" content="Clay Caudell"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Clay Caudell</a></div><div class="site-subtitle font-italic">Reverse Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/cwcaude" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['contact.cwcaude','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>iOS Tweak Development : 4</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>iOS Tweak Development : 4</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1594929600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 16, 2020 </em> </span> <span> Updated <em class="" data-ts="1659580908" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 3, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/cwcaude">Clay Caudell</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1611 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><h1 id="note">Note</h1><p>This series of posts is not made as strictly a <em>tutorial</em> While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to <strong>explain</strong> and <strong>document</strong> my journey/path of learning to develop iOS tweaks. If you desire for strictly a tutorial in iOS Tweak Development check out these links here : <a href="https://www.youtube.com/watch?v=uNXd4KLLjhk&amp;list=PLFWEDfSyl7h_K8Ew4rwTzlUPgWU7nKYri">Zane Helton</a> or <a href="https://www.reddit.com/r/jailbreak/comments/839bnv/tutorial_how_to_get_into_tweak_development_for/">r/Jailbreak Tutorial</a></p><h1 id="adding-settings-options-to-my-tweak">Adding Settings options to my Tweak</h1><p>The next thing I wanted to learn is how to add a settings option to my tweak, this is how I did it.</p><h1 id="creating-a-preference-bundle">Creating a Preference Bundle</h1><p>In the settings app, each app that is listed has what is called a <em>Preference Bundle</em>. This Preference Bundle is what determines how the settings app will look and behave. To create a preference bundle that is linked with your current tweak, run <em>$THEOS/bin/nic.pl</em> from within the directory of your tweak and create a <em>preference bundle modern</em>.</p><h1 id="important-files-in-the-preference-bundle">Important Files in the Preference Bundle</h1><p>I will not be covering every file within the directory, however I will be listing the important ones I needed to modify.</p><h4 id="entryplist"><span class="mr-2">entry.plist</span><a href="#entryplist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Within this file, you can find the Label that will be seen from the main page of the settings application. As well as the name of the icon file that will be displayed on that page as well.</p><h4 id="msprootlistcontrollerh--m"><span class="mr-2">MSPRootListController<em>.h &amp; .m</em></span><a href="#msprootlistcontrollerh--m" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>It is within these files that you can create new methods to be used as actions within your preferences page.</p><h4 id="resourcesrootplist"><span class="mr-2">Resources/Root.plist</span><a href="#resourcesrootplist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here is where you will build your preferences page in XML. Each <em>part</em> of the preference page is called a cell, and within this file you can define the type of cell as well as modify properties of each cell. I will go into more detail on this later.</p><h4 id="resourcesinfoplist"><span class="mr-2">Resources/Info.plist</span><a href="#resourcesinfoplist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Not much (if anything) in this file is required to be modified, however this is where the bundle identifier is stored and can be modified. This is used by your tweak to access your preferences, as well as used by the OS to create the bundle to be saved.</p><h1 id="first-steps">First steps</h1><p>The first thing I did was begin building out the preferences page to include what I wanted for my tweak. I wanted: Enable Switch, Custom Text Switch, Custom Text Box, Website Link, and Donation Link. To add these sections to the preferences page I modified the Resources/Root.plist file. This file uses xml in order to build the page. In order to learn how to actually use this I used <a href="https://www.youtube.com/watch?v=iHEuM1e8V40">Zane Helton’s Tutorial</a> and <a href="https://iphonedevwiki.net/index.php/Preferences_specifier_plist">iPhoneDevWiki’s Site</a>. To explain it quickly, each page is made up of <em>cells</em>, you can view the different types of cells from <a href="https://iphonedevwiki.net/index.php/Preferences_specifier_plist">iPhoneDevWiki’s Site</a>.</p><h1 id="building-the-preferences-page">Building the preferences page</h1><p>The file is structured as an <em>array</em> of <em>dictionaries</em>, each dictionary specifies a cell. Here is an example of what a cell looks like:</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>	<span class="nt">&lt;dict&gt;</span>
		<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>PSSwitchCell<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>default<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;true/&gt;</span>
		<span class="nt">&lt;key&gt;</span>defaults<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>com.ziegen.messageswappreferences<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>key<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>isEnabled<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>Enabled<span class="nt">&lt;/string&gt;</span>
	<span class="nt">&lt;/dict&gt;</span>
</pre></table></code></div></div><p>This cell type is a <em>PSSwitchCell</em>, this is denoted using the *<key>* **cell** and following it with a *<string>* of the cell type. Again these cell types can be found on [iPhoneDevWiki's Site](https://iphonedevwiki.net/index.php/Preferences_specifier_plist).</string></key></p><p>Using the <em>default</em> key you can specify a default value for the cell, in the example above considering the cell type is a switch I set the default value to <em><true></true></em>. However if the cell was a <em>PSEditTextCell</em> like I use for the custom text, I would set the default to a *<string>* value.</string></p><p>In order to add persistence to the values of these cells you need to use the <em>defaults</em> key. You need to set this value to the bundle identifier you have specified in your <strong>Info.plist</strong> file, in my case it is <em>com.ziegen.messageswappreferences</em>. Directly following the <em>defaults</em> key, you need to set a <em>key</em> key which allows you to set a name to the value you are storing, you can think of it as naming the <em>variable</em> you are saving. You should set this name to be something unique that you can use to differentiate each value. In my example, because this switch controls whether or not the tweak is enabled or not, I set the name to <em>isEnabled</em>.</p><p>Finally the last part of this example you can see the <em>label</em> key, this sets the <em>(you guessed it)</em> <strong>label</strong> shown on the settings page.</p><h1 id="grouping-cells">Grouping Cells</h1><p>In order to group cells within this array you can define a new cell of <em>PSGroupCell</em>, every cell following this cell until the next <em>PSGroupCell</em> is included within that group. Here is an example of a group cell:</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>	<span class="nt">&lt;dict&gt;</span>
		<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>PSGroupCell<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>Settings<span class="nt">&lt;/string&gt;</span>
	<span class="nt">&lt;/dict&gt;</span>
</pre></table></code></div></div><p>As you can see it’s a rather simple cell, with only the cell specifier and a label to display above the cell.</p><h1 id="adding-actions-to-the-buttons-on-the-settings-page">Adding <strong>actions</strong> to the buttons on the Settings page</h1><p>In order to add actually functionality to the buttons on the settings page, you must create a method within the <em>MSPRootListController.m</em> file to be executed when the button is pressed. In my example, my buttons simply open websites. This is the code for that method to be included within the <em>MSPRootListController</em> implementation:</p><div class="language-objc highlighter-rouge"><div class="code-header"> <span data-label-text="Objective-C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">openWebsite</span><span class="p">{</span>
	<span class="p">[[</span><span class="n">UIApplication</span> <span class="nf">sharedApplication</span><span class="p">]</span>
	<span class="nl">openURL:</span><span class="p">[</span><span class="n">NSURL</span> <span class="nf">URLWithString</span><span class="p">:</span><span class="s">@"https://cwcaude.github.io/"</span><span class="p">]</span>
	<span class="nl">options:</span><span class="p">@{}</span>
	<span class="nl">completionHandler:</span><span class="nf">nil</span><span class="p">];</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="full-file">Full File</h1><p>Here I am going to paste the full <em>Root.plist</em> file and a screenshot of what it looks like so you can compare directly how each line affects the page. It may look overwhelming at first, but it is very easy to understand if you take a moment to analyze it.</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>
	<span class="nt">&lt;key&gt;</span>items<span class="nt">&lt;/key&gt;</span>
	<span class="nt">&lt;array&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSGroupCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Settings<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSSwitchCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>default<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;true/&gt;</span>
			<span class="nt">&lt;key&gt;</span>defaults<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>com.ziegen.messageswappreferences<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>key<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>isEnabled<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Enabled<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSSwitchCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>default<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;false/&gt;</span>
			<span class="nt">&lt;key&gt;</span>defaults<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>com.ziegen.messageswappreferences<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>key<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>isCustom<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Custom Text<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSGroupCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Custom Text to Display<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSEditTextCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>default<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Custom<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>defaults<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>com.ziegen.messageswappreferences<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>key<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>displayText<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSGroupCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Credits<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
		<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSButtonCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Learn how I made this tweak<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>action<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>openWebsite<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
				<span class="nt">&lt;dict&gt;</span>
			<span class="nt">&lt;key&gt;</span>cell<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>PSButtonCell<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>label<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>Buy me a Coffee<span class="nt">&lt;/string&gt;</span>
			<span class="nt">&lt;key&gt;</span>action<span class="nt">&lt;/key&gt;</span>
			<span class="nt">&lt;string&gt;</span>openDonation<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;/dict&gt;</span>
	<span class="nt">&lt;/array&gt;</span>
	<span class="nt">&lt;key&gt;</span>title<span class="nt">&lt;/key&gt;</span>
	<span class="nt">&lt;string&gt;</span>Message Swap<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</pre></table></code></div></div><p><a href="/assets/iOS-tweak-dev-4-SettingsPage.jpeg" class="popup img-link "><img data-src="/assets/iOS-tweak-dev-4-SettingsPage.jpeg" alt="Screenshot of Settings Page" class="lazyload" data-proofer-ignore></a></p><h1 id="modifying-the-tweak-to-use-this-preference-bundle-data">Modifying the tweak to use this Preference Bundle Data</h1><p>In the last post I developed the <em>Tweak.xm</em> to modify the values with a hard-coded value. However with this new preferences page I need to add the ability to modify the tweak with different settings changed within the preference page. To do this I created some new functions to access this data from the <em>plist bundle</em>.</p><div class="language-objc highlighter-rouge"><div class="code-header"> <span data-label-text="Objective-C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="cp">#define PLIST_PATH @"/var/mobile/Library/Preferences/com.ziegen.messageswappreferences.plist"
</span>
<span class="kr">inline</span> <span class="n">bool</span> <span class="nf">GetPrefBool</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">[[[</span><span class="n">NSDictionary</span> <span class="nf">dictionaryWithContentsOfFile</span><span class="p">:</span><span class="n">PLIST_PATH</span><span class="p">]</span> <span class="nf">valueForKey</span><span class="p">:</span><span class="n">key</span><span class="p">]</span> <span class="nf">boolValue</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">NSString</span><span class="o">*</span> <span class="nf">GetPrefString</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">[[[</span><span class="n">NSDictionary</span> <span class="nf">dictionaryWithContentsOfFile</span><span class="p">:</span><span class="n">PLIST_PATH</span><span class="p">]</span> <span class="nf">valueForKey</span><span class="p">:</span><span class="n">key</span><span class="p">]</span> <span class="nf">stringValue</span><span class="p">];</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Here you can see I defined the <em>PLIST_PATH</em> so that it can be more easily used within the functions defined below it.</p><p>Each of these functions queries the <em>plist bundle</em> file and accesses the preferences saved via the <em>defaults</em> we set up earlier. Each function returns a specific type of value, for example the <em>GetPrefBool</em> returns boolean values that could be given from a switch. While the <em>GetPrefString</em> returns a value that returns a string value from a text box. Another function I could make would be one that would return a float.</p><p>In order to get the value you want from these functions you would make a call like this <code class="language-plaintext highlighter-rouge">GetPrefBool(@"isEnabled")</code> Here you can see I am returning a Boolean value from the key <em>“isEnabled”</em>, this will of course return the status of our enabled switch. Here you can see both of the functions utilized with a hook to control the program using these values from the preference bundle:</p><div class="language-objc highlighter-rouge"><div class="code-header"> <span data-label-text="Objective-C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="o">%</span><span class="n">hook</span> <span class="n">_UINavigationBarLargeTitleView</span>

	<span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setTitle</span><span class="p">:</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="nv">arg1</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">GetPrefBool</span><span class="p">(</span><span class="s">@"isEnabled"</span><span class="p">))</span>
	<span class="p">{</span>		
		<span class="k">if</span> <span class="p">(</span><span class="n">GetPrefBool</span><span class="p">(</span><span class="s">@"isCustom"</span><span class="p">))</span>	<span class="p">{</span>
			<span class="o">%</span><span class="n">orig</span><span class="p">(</span><span class="n">GetPrefString</span><span class="p">(</span><span class="s">@"customText"</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="o">%</span><span class="n">orig</span><span class="p">(</span><span class="s">@"Intel"</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
			<span class="o">%</span><span class="n">orig</span><span class="p">(</span><span class="s">@"Messages"</span><span class="p">);</span>
		<span class="p">}</span>
<span class="p">}</span>

<span class="o">%</span><span class="n">end</span>
</pre></table></code></div></div><p>Here the <em>GetPrefBool</em> function is used as the argument in simple <em>if/else</em> statements to control the flow of the tweak since it will return a <em>true</em> or <em>false</em> value. The <em>GetPrefString</em> function is used as the argument to the <em>%orig()</em> call to give the string of the custom text stored in the specified key.</p><h1 id="howd-it-turn-out">How’d it turn out?</h1><p>Screenshot with the tweak disabled:</p><p><a href="/assets/iOS-tweak-dev-4-disabled.PNG" class="popup img-link "><img data-src="/assets/iOS-tweak-dev-4-disabled.PNG" alt="DisabledScreenshot" class="lazyload" data-proofer-ignore></a></p><p>Screenshot with the tweak enabled but custom disabled:</p><p><a href="/assets/iOS-tweak-dev-4-Enabled.PNG" class="popup img-link "><img data-src="/assets/iOS-tweak-dev-4-Enabled.PNG" alt="NoCustomScreenshot" class="lazyload" data-proofer-ignore></a></p><p>Screenshot with Custom enabled:</p><p><a href="/assets/iOS-tweak-dev-4-Custom.PNG" class="popup img-link "><img data-src="/assets/iOS-tweak-dev-4-Custom.PNG" alt="CustomScreenshot" class="lazyload" data-proofer-ignore></a></p><p>Obligatory Meme Screenshot:</p><p><a href="/assets/iOS-tweak-dev-4-11Dollas.PNG" class="popup img-link "><img data-src="/assets/iOS-tweak-dev-4-11Dollas.PNG" alt="11Dollaridoos" class="lazyload" data-proofer-ignore></a></p><h1 id="want-to-install-this-tweak">Want to install this tweak?</h1><p>You can install this right now from Cydia from the repo here: https://cwcaude.github.io Any issues you have with this tweak should be posted as an issue to the Github page. <a href="https://github.com/cwcaude/MessageSwap/issues">Link Here</a></p><h1 id="what-next">What next?</h1><p>This tweak now looks like it’s something presentable! However now I want to add more functionality to the tweak such as an unread messages counter, and controlling the color of that text. So that is what I’ll be working on for next post! If you are enjoying these posts and would like to support me I have a donation link down below. Any questions or comments about this post can be sent to my email and I will try to respond quickly!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ios-tweak-development/'>iOS_Tweak_Development</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=iOS%20Tweak%20Development%20:%204%20-%20Clay%20Caudell&url=http%3A%2F%2Fcwcaude.github.io%2Fposts%2FiOS-tweak-dev-4%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=iOS%20Tweak%20Development%20:%204%20-%20Clay%20Caudell&u=http%3A%2F%2Fcwcaude.github.io%2Fposts%2FiOS-tweak-dev-4%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Fcwcaude.github.io%2Fposts%2FiOS-tweak-dev-4%2F&text=iOS%20Tweak%20Development%20:%204%20-%20Clay%20Caudell" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SqrlWfl-1/">SquirrelWaffle Static Analysis</a><li><a href="/posts/iOS-tweak-dev-1/">iOS Tweak Development : 1</a><li><a href="/posts/iOS-tweak-dev-2/">iOS Tweak Development : 2</a><li><a href="/posts/iOS-tweak-dev-3/">iOS Tweak Development : 3</a><li><a href="/posts/Hello-World/">Hello World!</a></ul></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/iOS-tweak-dev-1/"><div class="card-body"> <em class="small" data-ts="1593720000" data-df="ll" > Jul 2, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iOS Tweak Development : 1</h3><div class="text-muted small"><p> Note This series of posts is not made as strictly a tutorial. While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain a...</p></div></div></a></div><div class="card"> <a href="/posts/iOS-tweak-dev-2/"><div class="card-body"> <em class="small" data-ts="1593892800" data-df="ll" > Jul 4, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iOS Tweak Development : 2</h3><div class="text-muted small"><p> Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain an...</p></div></div></a></div><div class="card"> <a href="/posts/iOS-tweak-dev-3/"><div class="card-body"> <em class="small" data-ts="1594584000" data-df="ll" > Jul 12, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iOS Tweak Development : 3</h3><div class="text-muted small"><p> Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain an...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/iOS-tweak-dev-3/" class="btn btn-outline-primary" prompt="Older"><p>iOS Tweak Development : 3</p></a> <a href="/posts/iOS-tweak-dev-5/" class="btn btn-outline-primary" prompt="Newer"><p>iOS Tweak Development : 5</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/cwcaude">Clay Caudell</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
