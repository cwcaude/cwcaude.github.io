<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Reverse Engineering Vehicle Update Files" /><meta property="og:locale" content="en" /><meta name="description" content="Backstory / Introduction I own a relatively new Dodge vehicle, one new enough to have a touch screen infotainment system, and require system updates. Well recently my vehicle was prompted with an update, and I became curious as to what this update file actually contained. So I navigated to Dodge’s update website, downloaded the respective update file, and tried to see what I could learn about it. These are some of the things I learned and was able to find out about this file." /><meta property="og:description" content="Backstory / Introduction I own a relatively new Dodge vehicle, one new enough to have a touch screen infotainment system, and require system updates. Well recently my vehicle was prompted with an update, and I became curious as to what this update file actually contained. So I navigated to Dodge’s update website, downloaded the respective update file, and tried to see what I could learn about it. These are some of the things I learned and was able to find out about this file." /><link rel="canonical" href="http://cwcaude.github.io/posts/update-analysis/" /><meta property="og:url" content="http://cwcaude.github.io/posts/update-analysis/" /><meta property="og:site_name" content="Clay Caudell" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-25T20:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Reverse Engineering Vehicle Update Files" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-04T02:41:48+00:00","datePublished":"2020-11-25T20:00:00+00:00","description":"Backstory / Introduction I own a relatively new Dodge vehicle, one new enough to have a touch screen infotainment system, and require system updates. Well recently my vehicle was prompted with an update, and I became curious as to what this update file actually contained. So I navigated to Dodge’s update website, downloaded the respective update file, and tried to see what I could learn about it. These are some of the things I learned and was able to find out about this file.","headline":"Reverse Engineering Vehicle Update Files","mainEntityOfPage":{"@type":"WebPage","@id":"http://cwcaude.github.io/posts/update-analysis/"},"url":"http://cwcaude.github.io/posts/update-analysis/"}</script><title>Reverse Engineering Vehicle Update Files | Clay Caudell</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Clay Caudell"><meta name="application-name" content="Clay Caudell"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Clay Caudell</a></div><div class="site-subtitle font-italic">Reverse Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/cwcaude" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['contact.cwcaude','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Reverse Engineering Vehicle Update Files</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Reverse Engineering Vehicle Update Files</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1606334400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 25, 2020 </em> </span> <span> Updated <em class="" data-ts="1659580908" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 3, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/cwcaude">Clay Caudell</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1943 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="backstory--introduction">Backstory / Introduction</h1><p>I own a relatively new Dodge vehicle, one new enough to have a touch screen infotainment system, and require system updates. Well recently my vehicle was prompted with an update, and I became curious as to what this update file actually contained. So I navigated to Dodge’s update website, downloaded the respective update file, and tried to see what I could learn about it. These are some of the things I learned and was able to find out about this file.</p><h1 id="update-contents">Update Contents</h1><p>The first thing I wanted to do was see what files I had to work with. Unzipping the file presented me with the following files:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>checkswdl.bat
KaliSWDL.log
md5deep
swdl.upd
swdl.upd.md5
</pre></table></code></div></div><h2 id="kaliswdllog"><span class="mr-2">KaliSWDL.log</span><a href="#kaliswdllog" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This file contains the output of what I assume is the compilation or packing of this update file. Not too much interesting information is found here.</p><h2 id="md5deepexe"><span class="mr-2">md5deep.exe</span><a href="#md5deepexe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This file is an executable that performs and md5 hash of a file. This is used later to check the update file against a known correct hash.</p><h2 id="checkswdlbat"><span class="mr-2">checkswdl.bat</span><a href="#checkswdlbat" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>‘checkswdl’ is a batch script that runs the output of md5deep with swdl.upd and compares it against swdl.upd.md5. This ensures the hash is correct and that the file was successfully downloaded without corruption or issues. It also contains these cool ASCII art drawings to give you visual of whether or not the file passes the hash check.</p><h3 id="file-passed"><span class="mr-2">File Passed:</span><a href="#file-passed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>             _@_
            ((@))
            ((@))
            ((@))
 ______===(((@@@@====)
 ##########@@@@@=====))
 ##########@@@@@----))
 ###########@@@@----)
 ========-----------
:
 !!!  FILE IS GOOD  !!!!
:
</pre></table></code></div></div><h3 id="file-failed"><span class="mr-2">File Failed:</span><a href="#file-failed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>  .=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-.
  |                     ______                     |
  |                  .-"      "-.                  |
  |                 /            \                 |
  |     _          |              |          _     |
  |    ( \         |,  .-.  .-.  ,|         / )    |
  |     &gt; "=._     | )(__/  \__)( |     _.=" &lt;     |
  |    (_/"=._"=._ |/     /\     \| _.="_.="\_)    |
  |           "=._"(_          _)"_.="             |
  |               "=\__|IIIIII|__/="               |
  |              _.="| \IIIIII/ |"=._              |
  |    _     _.="_.="\          /"=._"=._     _    |
  |   ( \_.="_.="     `--------`     "=._"=._/ )   |
  |    &gt; _.="                            "=._ &lt;    |
  |   (_/                                    \_)   |
  |                                                |
  '-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-='
 :
  ***   FILE IS BAD   ***
 :
</pre></table></code></div></div><h2 id="swdlupdmd5"><span class="mr-2">swdl.upd.md5</span><a href="#swdlupdmd5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is the known good hash of the update file. This again is used in checkswdl.bat in order to ensure the update file was downloaded correctly.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>MD5(swdl.upd)= 536fb9f643beb374bc9be69d129436b3
</pre></table></code></div></div><h2 id="swdlupd"><span class="mr-2">swdl.upd</span><a href="#swdlupd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Finally that brings us to swdl.upd, this is the meat and potatoes of the whole post. This is the update file and contains the interesting stuff I really want to take a look at. The rest of this post will be the dive into figuring out how to look at the stuff found in this file.</p><h1 id="dissecting-the-update">Dissecting the Update</h1><p>Now that we know everything contained in this file, how do I actually find the interesting stuff to view within the file?</p><h2 id="what-kind-of-file-is-this-anyway"><span class="mr-2">What kind of file is this anyway?</span><a href="#what-kind-of-file-is-this-anyway" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Well in order to find out what kind of file I am working with, I first decided to use the wonderful linux tool <em>file</em>. Here you can see the return from this tool.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ file swdl.upd
swdl.upd: ISO 9660 CD-ROM filesystem data 'CDROM'
</pre></table></code></div></div><p>So it appears to be a CD-ROM file, we can actually confirm this by taking a look at the KaliSWDL.log file we found earlier.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Warning: Creating ISO-9660:1999 (version 2) filesystem.
</pre></table></code></div></div><p>Near the bottom of this log we can find this line, which references the ISO-9660 filesystem being created.</p><h2 id="whats-in-this-thing"><span class="mr-2">What’s in this thing?</span><a href="#whats-in-this-thing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The next step I wanted to do was to see what I could find out about the contents of this file. To do this is pretty straight forward as I used another tool called <em>binwalk</em> in order to see what it could find out about the file and its contents. Now I won’t post the full output of the tool, as it is quite large. However I will provide a few snippets that allows you to see exactly what has been output from the tool.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
172032        0x2A000         ELF, 32-bit LSB executable, ARM, version 1 (SYSV)
245760        0x3C000         ELF, 32-bit LSB executable, ARM, version 1 (SYSV)
339800        0x52F58         Unix path: /etc/system/config/nand_partition.txt
363816        0x58D28         Unix path: /../../libgcc/../gcc
365162        0x5926A         Unix path: /../../libgcc/../gcc/config/arm
365683        0x59473         Unix path: /../../libgcc/../gcc
367524        0x59BA4         Unix path: /../../libgcc/../gcc/libgcc2.c
400331        0x61BCB         Unix path: /etc/system/config/nand_partition.txt )
427192        0x684B8         Unix path: /fs/etfs/tmp/tracelog/traces.log
427259        0x684FB         Unix path: /fs/etfs/tracescopes/links/HMI.hbtc
427321        0x68539         Unix path: /fs/etfs/usr/share/flash/scopes/scopelist
</pre></table></code></div></div><p>From this first snippet of showing the first few files discovered in the file, you can see some interesting things. Firstly there are two ELF files that appear to be compiled for ARM, these are interesting and I may have to dissect them in their own post sometime in the future. But overall you can see that the output is providinga hexadecimal offset to each different file provided in the output. As well as a description, or filepath name. As this output is 75,000 lines long I will spare you the full log. However I will be highlighting specific snippets as I pulled out data from this file.</p><h2 id="cutting-out-files"><span class="mr-2">“Cutting out” files</span><a href="#cutting-out-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that I essentially had a map of the files contained within this file, I can begin cutting out files I have an interest in. To do this I will use another linux tool, <em>dd</em>. This tool functions by directly copying chunks of data from specific offsets of a file to another file. Since I have the offset of each file and the file following it. I can simply copy the middle section between those offsets in order to grab the files I desire. Let’s find something I want to extract:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>550015658     0x20C892AA      Zip archive data, at least v2.0 to extract,   
    compressed size: 1527, uncompressed size: 1821, name: res/images/logo-lrg.png
550017238     0x20C898D6      Zip archive data, at least v2.0 to extract, 
    compressed size: 1167, uncompressed size: 1473, name: res/images/logo-sml.png
</pre></table></code></div></div><p>So here we can see this <em>logo-lrg.png</em> file I desire to pull out of the update. Using <em>dd</em> and the provided offsets I should be able to pull this file out relatively easily.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dd if=swdl.upd of=logo-lrg.zip bs=1 skip=$((0x20C892AA)) count=$((0x20C898D6-0x20C892AA))
</pre></table></code></div></div><p>I’ll quickly explain what each option does in this command:</p><h3 id="if"><span class="mr-2">if=</span><a href="#if" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>You specify the input file to the tool, or the file you will be extracting from. ### of= 
You specify the output file here, or the file you will be writing to.  ### bs=
You can specify the block size to be copied here, you can make this larger to copy things faster. However if you make this larger you will have to divide the next options by this same value in order to account for the change in block size. I will leave this '1' for clarity's sake.  ### skip=
Here you give the offset to the beginning of the file you wish to extract.  ### count=
This is how many blocks of data you will be copying from the file. In order to get this value, you can subtract the next file's initial offset from the file you wish to copy. The difference between these values is the number of 'blocks' in the file. In our case since a block is a single byte, it is the number of bytes between the two offsets. 
</pre></table></code></div></div><p>Running this command given above provides the following output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>1580+0 records in
1580+0 records out
1580 bytes (1.6 kB, 1.5 KiB) copied, 0.0219515 s, 72.0 kB/s
</pre></table></code></div></div><p>And also we can see a new <em>logo-lrg.zip</em> file in our directory. So let’s open that up and view our picture.</p><p><a href="/assets/update-analysis-winrarError.png" class="popup img-link "><img data-src="/assets/update-analysis-winrarError.png" alt="WinrarError" class="lazyload" data-proofer-ignore></a></p><p>Erm, what happened? I thought this would work. I can see the files within the zip, but when I attempt to extract the png to view it I keep getting this error. Well after checking… and checking… <em>and checking</em> my <em>dd</em> options to ensure I did everything correct I finally figured out you can just repair archives through Winrar. Well let’s give this a shot…</p><p><a href="/assets/update-analysis-winrarRepair.png" class="popup img-link "><img data-src="/assets/update-analysis-winrarRepair.png" alt="WinrarRepair" class="lazyload" data-proofer-ignore></a></p><h3 id="ta-da"><span class="mr-2">TA-DA!</span><a href="#ta-da" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I successfully pulled out the logo file and prove now I can get any file I want from this update file.</p><p><a href="/assets/update-analysis-Logo.png" class="popup img-link "><img data-src="/assets/update-analysis-Logo.png" alt="LogoFile" class="lazyload" data-proofer-ignore></a></p><h2 id="what-else-can-i-find"><span class="mr-2">What else can I find?</span><a href="#what-else-can-i-find" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that we can successfully pull files out of this update, what is there for me to find within this file? Aside from random images and the two ELF binaries I found earlier, most of what I found are random text files and a whole heck of a lot of <em>.class</em> files. After digging into a bunch of text files finding nothing, I decided to figure out how to examine these <em>.class</em> files.</p><h2 id="decompiling-class-files"><span class="mr-2">Decompiling .class files</span><a href="#decompiling-class-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So I got one of these <em>.class</em> files extracted, now what? Now I have never worked with Java before, however I know enough to at least recognize this is a Java. So I began digging to find out how to pull this file apart and see what’s inside. Opening it directly in a text editor is no help as it just seems like a garbled mess of characters. This led me to believe that it was compiled in some way, <em>(again I know very little about Java)</em>. So I began searching for ways to decompile Java files. I came across a tool simply called <em>Java Decompiler</em>, specifically I was interested in using <em>JD-GUI</em> a standalone utility that would hopefully allow me to decompile this class file. Opening this tool, you are presented with a very easy to use GUI that just lets you navigate to the file you wish to decompile and open it.</p><p><a href="/assets/update-analysis-jdguiOpen.png" class="popup img-link "><img data-src="/assets/update-analysis-jdguiOpen.png" alt="JD-GUI Home" class="lazyload" data-proofer-ignore></a></p><p>The file I decided to try and decompile first was a file called <em>SteeringWheelAngleUpdate.class</em>. Success!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>import GuiData.SensorDataUpdate;
import InternalInterface.SteeringWheelAngleUpdate;
import com.uniquesoft.tdl.system.SystemUtils;
import com.uniquesoft.tdl.system.TDLObject;

public class SteeringWheelAngleUpdate implements TDLObject {
  public SensorDataUpdate sensor_data;
  
  public void destroy() {}
  
  public boolean equals(SteeringWheelAngleUpdate copy) {
    return SystemUtils.tdlEquals(this.sensor_data, copy.sensor_data);
  }
  
  public boolean excleq(TDLObject copy) {
    return !equals(copy);
  }
  
  public boolean equals(Object copy) {
    if (getClass() == copy.getClass())
      return equals((SteeringWheelAngleUpdate)copy); 
    return false;
  }
  
  public int hashCode() {
    return 0x1 ^ ((this.sensor_data == null) ? 0 : this.sensor_data.hashCode());
  }
  
  public SteeringWheelAngleUpdate deepCopy() {
    return new SteeringWheelAngleUpdate(this);
  }
  
  public SteeringWheelAngleUpdate(SteeringWheelAngleUpdate copy) {
    this.sensor_data = copy.sensor_data;
  }
  
  public SteeringWheelAngleUpdate() {}
  
  public SteeringWheelAngleUpdate(SensorDataUpdate sensor_data) {
    this.sensor_data = sensor_data;
  }
}
</pre></table></code></div></div><p>Opening this file within JDGUI I was greeted with a decompiled version of the original Java file. I now had a way to view any of these Java files I desired.</p><h2 id="thats-all-for-now"><span class="mr-2">That’s all! <em>For Now…</em></span><a href="#thats-all-for-now" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Well I accomplished my original goal of learning what exactly is in these update files. Now I must decide what I want to do next? I originally went into this desiring to make my own custom themes for the system. I did manage to find the theme files in the Shockwave Flash format, so there is potential there to build my own custom ones. Maybe I’ll reverse engineer those ELF Binaries I found to see what I can find. For now though I am satisfied with what I have learned so far.</p><h2 id="thanks-for-reading"><span class="mr-2">Thanks for reading</span><a href="#thanks-for-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I hope you found something in this post entertaining or educational! I post these in order to inspire others to work on projects of their own. If you want to share any projects with me or ask any questions feel free to shoot me an email provided at the footer of this page. Thanks!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse_Engineering</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Reverse%20Engineering%20Vehicle%20Update%20Files%20-%20Clay%20Caudell&url=http%3A%2F%2Fcwcaude.github.io%2Fposts%2Fupdate-analysis%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Reverse%20Engineering%20Vehicle%20Update%20Files%20-%20Clay%20Caudell&u=http%3A%2F%2Fcwcaude.github.io%2Fposts%2Fupdate-analysis%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Fcwcaude.github.io%2Fposts%2Fupdate-analysis%2F&text=Reverse%20Engineering%20Vehicle%20Update%20Files%20-%20Clay%20Caudell" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SqrlWfl-1/">SquirrelWaffle Static Analysis</a><li><a href="/posts/iOS-tweak-dev-1/">iOS Tweak Development : 1</a><li><a href="/posts/iOS-tweak-dev-2/">iOS Tweak Development : 2</a><li><a href="/posts/iOS-tweak-dev-3/">iOS Tweak Development : 3</a><li><a href="/posts/Hello-World/">Hello World!</a></ul></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SqrlWfl-1/"><div class="card-body"> <em class="small" data-ts="1661549400" data-df="ll" > Aug 26, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SquirrelWaffle Static Analysis</h3><div class="text-muted small"><p> Preface This is the first write-up I’ll be publishing as I delve into malware analysis. For this post I will be using the config extraction work of Sergei Frankoff, co-founder of OpenAnalysis, as a...</p></div></div></a></div><div class="card"> <a href="/posts/iOS-tweak-dev-5/"><div class="card-body"> <em class="small" data-ts="1595448000" data-df="ll" > Jul 22, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iOS Tweak Development : 5</h3><div class="text-muted small"><p> Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain an...</p></div></div></a></div><div class="card"> <a href="/posts/iOS-tweak-dev-4/"><div class="card-body"> <em class="small" data-ts="1594929600" data-df="ll" > Jul 16, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iOS Tweak Development : 4</h3><div class="text-muted small"><p> Note This series of posts is not made as strictly a tutorial While I will be explaining how things work and giving instruction on iOS tweak development, the purpose of this posting is to explain an...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/iOS-tweak-dev-5/" class="btn btn-outline-primary" prompt="Older"><p>iOS Tweak Development : 5</p></a> <a href="/posts/SqrlWfl-1/" class="btn btn-outline-primary" prompt="Newer"><p>SquirrelWaffle Static Analysis</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/cwcaude">Clay Caudell</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
